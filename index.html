<!DOCTYPE html> 
<html> 
  <head> 
    <title>SPARC</title> 

  	<link class="include" rel="stylesheet" type="text/css" href="dist/jquery.jqplot.min.css" />
  	<link rel="stylesheet" type="text/css" href="dist/jquery.jqplot.css"/>
  	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />

    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
        <script>
            $('#accountOverview').live('pageshow',function(event){
              //var plot1 = $.jqplot ('chart1', [[3,7,9,1,5,3,8,2,5]]);
            });
            //function called when device page is shown
            $('#devices').live('pageshow',function(event){
                //code to call webservice
                $.ajax({
                  type: 'GET',
                  url: "http://localhost:8080/com.sparc.webservice/ws/sparc/getDeviceList?callback=deviceListCallback",
                  async: false,
                  contentType: "application/json",
                  dataType: 'jsonp'
                });
           });
            //callback function specified in url above this is where you convert teh JSON into html
            function deviceListCallback(response)
            {
                //this displays the response in the chrome console, this will be replaced with code to convert
                // the json into html
               var list = '<div data-role="collapsible-set" data-collapsed-icon="arrow-r" data-expanded-icon="arrow-d" data-iconpos="right" data-content-theme="d">';
                for(i=0; i< response.deviceList.length; i++) {
                    var type = response.deviceList[i].type;
                    list += '<div data-role="collapsible" data-collapsed="true">';
                    list += '<h3>' + response.deviceList[i].name + '</h3>';
                    list += '<select data-role="slider" name="'+ response.deviceList[i].name +' id=" '+response.deviceList[i].id+'"><option value="off">Off</option><option value="on">On</option></select>';
                    list += '<p>Power Consumption: ' + response.deviceList[i].powerConsumption + '</p>';
                    if(type == "hvac") {

                    }
                    else if(type == "light") {

                    }
                    else if(type == "plug") {

                    }
                    else {

                    }
                    list += '<a href="#" data-role="button" data-inline="true">Edit</a> <a href="#" data-role="button" data-inline="true">Schedule</a>'+'</div>';
                } 
               $('div.deviceList').html(list).trigger('create');
               //note the .trigger('create') makes sure the Jquery mobiel styles are applied to dynamic content  
            }
            $('#incentives').live('pageshow',function(event){
                //code to call webservice
                $.ajax({
                  type: 'GET',
                  url: "http://localhost:8080/com.sparc.webservice/ws/sparc/getIncentiveList?callback=incentiveListCallback",
                  async: false,
                  contentType: "application/json",
                  dataType: 'jsonp'
                });
           });
          function incentiveListCallback(response)
            {
              
               $('div.incentiveList').html("incentives").trigger('create');
               //note the .trigger('create') makes sure the Jquery mobile styles are applied to dynamic content  
            }
            $('#notifications').live('pageshow',function(event){
                //code to call webservice
                $.ajax({
                  type: 'GET',
                  url: "http://localhost:8080/com.sparc.webservice/ws/sparc/getNotificationList?callback=notificationListCallback",
                  async: false,
                  contentType: "application/json",
                  dataType: 'jsonp'
                });
           });
          function notificationListCallback(response)
            {
              
               $('div.notificationList').html("incentives").trigger('create');
               //note the .trigger('create') makes sure the Jquery mobile styles are applied to dynamic content  
            }
      </script> 
  </head> 
  <body> 
    <div data-role="page" id="login">
      <div data-role="header">
        <h1>Page Title</h1>
      </div>
      <div data-role="content">
 
        <form action="test.php" method="POST">
          <fieldset data-role="controlgroup">
            <input type="text" name="username" id="username" value="" placeholder="Username"/>
            <input type="text" name="password" id="password" value="" placeholder="Password"/>
            <input type="submit" name="login" id="login" value="Login" />
          </fieldset>    
        </form>
        <p><a href="#accountOverview" data-role="button">Bypass</a></p> 
      </div>
    </div>

    <div data-role="page" id="accountOverview">
      <div data-role="header">
        <a href="#login" data-icon="delete">Logout</a>
        <h1>AccountOverview</h1>
      </div>
      <div data-role="content">
        <!-- <div style="text-align:center;background-color:rgb(150,150,150);width:100%;height:150px;">Graph Area</div> -->
		<div id="chart1" style="height:150px; width:100%;"></div>
        <p style="margin:5%;">Power Consumption: 0 kW </br> Devices Runnning: 4/10 </br> Power Incentives: meh</p>
        <p><a href="#devices" data-role="button">Devices</a></p>
        <p><a href="#incentives" data-role="button">Incentives</a></p>
        <p><a href="#notifications" data-role="button">Notifcations</a></p>
      </div>
    </div>

    <div data-role="page" id="devices">
      <div data-role="header">
        <a href="#accountOverview" data-icon="back">Back</a>
        <h1>Devices</h1>
        <a href="#add" data-icon="create">Add</a>
        <div data-role="navbar">
          <ul>
            <li><a class="ui-btn-active" href="#">All</a></li>
            <li><a href="#">Type</a></li>
            <li><a href="#">Location</a></li>
          </ul>
        </div>
      </div>
   
      <div data-role="content" class="deviceList" class="deviceList"> 
        <div data-role="collapsible-set" data-collapsed-icon="arrow-r" data-expanded-icon="arrow-d" data-iconpos="right" data-content-theme="d" >
          <div data-role="collapsible" data-collapsed="true">
            <h3>Device 1</h3>
            <select name="flip-1" id="flip-1" data-role="slider" style="float:right;">
              <option value="off">Off</option>
              <option value="on">On</option>
            </select>

            <p>I'm the collapsible set content for section 1.</p>
          </div>
          <div data-role="collapsible">
            <h3>Device 2</h3>
            <p>I'm the collapsible set content for section 2.</p>
          </div>
        </div>
      </div>
    </div>

    <div data-role="page" id="incentives">
      <div data-role="header">
        <a href="#accountOverview" data-icon="back">Back</a>
        <h1>Incentives</h1>
      </div>
      <div data-role="content"> 
        <p>meh</p>
      </div>
    </div>

    <div data-role="page" id="notifications">
      <div data-role="header">
        <a href="#accountOverview" data-icon="back">Back</a>
        <h1>Notifications</h1>
      </div>
      <div data-role="content"> 
        <p>meh</p>  
      </div>
    </div>

    <div data-role="page" id="add">
      <div data-role="header">
        <a href="#devices" data-icon="back">Back</a>
        <h1>Add Device</h1>
      </div>
      <div data-role="content"> 
        <form action="form.php" method="post">
          <fieldset data-role="controlgroup">
            <input type="text" name="bacnetid" id="bacnetid" value="" placeholder="BACNet Id"/>
            <input type="submit" name="sync" id="sync" value="Sync" />
          </fieldset>    
        </form> 
        <p><a href="#create" data-role="button">Bypass</a></p> 
      </div>
    </div>  

    <div data-role="page" id="create">
      <div data-role="header">
        <a href="#add" data-icon="back">Back</a>
        <h1>Create Device</h1>
      </div>
      <div data-role="content"> 
        <form action="form.php" method="post">
          <h3>Enter Device Info below:</h3>
            <div data-role="fieldcontain">
              <label for="name">Name:</label>
              <input type="text" name="name" id="name" value="" placeholder="Device Name"/>
            </div>
            <div data-role="fieldcontain">
              <label for="name">Location:</label>
              <input type="text" name="location" id="location" value="" placeholder="Device Location"/>
            </div>
            <div data-role="fieldcontain">
              <label for="name">Priority:</label>
              <select name="priority" id="priority" >
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
              </select> 
            </div>

            <input type="submit" name="create" id="create" value="Create" />
        </form> 
      </div>
    </div> 

    <div data-role="page" id="edit">
      <div data-role="header">
        <h1>Edit Device</h1>
      </div>
      <div data-role="content"> 
        <p>meh</p>  
      </div>
    </div>

  </body>
</html>